<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cmm.service.impl.ComMapper">

	<!-- ######################################################################  -->
	<!-- 거래처 리스트 조회 -->
	<select id="selectAccountList" resultType="egovMap">
		SELECT 
			AC_KEY
			, AC_BUSI_NUM
			, AC_NM
		FROM CMM_ACCOUNT_TB
		ORDER BY AC_NM		
	</select>
	
	<!-- 거래처 담당자 리스트 조회 -->
	<select id="selectAcDirectorList" parameterType="String" resultType="egovMap">			
		SELECT AC_DIRECTOR_KEY
			, AC_DIRECTOR_NM
			, CONCAT(AC_DIRECTOR_POSITION_NM , ' / ' , AC_DIRECTOR_MB_NUM , ' / ' , AC_DIRECTOR_EMAIL) AS AC_DIRECTOR_INFO
		FROM CMM_ACCOUNT_DIRECTOR_TB
		WHERE AC_KEY = #{acKey}
		ORDER BY AC_DIRECTOR_NM		
	</select>
	
	<!-- 사원리스트 조회 -->
	<select id="selectEmployeeList" resultType="egovMap">			
		SELECT EMP_KEY
			, EMP_NM
		FROM CMM_EMPLOYEE_TB
		ORDER BY EMP_NM		
	</select>
	
	
	<select id="makePrimaryKey" parameterType="String" resultType="String">			
		SELECT make_key(#{keyType}); commit;
	</select>
	
	<insert id="insertSalesInfo" parameterType="java.util.Map">
		INSERT INTO CMM_SALES_DETAIL_TB (
			SALES_CT_FK_KEY
			, SALES_CT_CLASS
			, SALES_TURN
			, SALES_COLLECT_RATE
			, SALES_TURN_AMOUNT
			, SALES_CHARGE_DT
			, SALES_BILL_FC_DT
			, SALES_COLLECT_FC_DT
			, SALES_COLLECT_FINISH_DT
			, SALES_GB_YN
			, SALES_STATUS_CD
			, REG_DT
			, REG_TM
			, REG_EMP_KEY
			, DELETE_YN
		) VALUES 
		<foreach collection="SalesVOList" item="item" separator=",">
			(
				#{salesCtFkKey}
				, #{item.salesCtClass}
				, #{item.salesTurn}
				, #{item.salesCollectRate}
				, #{item.salesTurnAmount}
				, #{item.salesChargeDt}
				, #{item.salesBillFcDt}
				, #{item.salesCollectFcDt}
				, #{item.salesCollectFinishDt}
				, #{item.salesGbYn}
				, #{item.salesStatusCd}
				, DATE_FORMAT(NOW(),'%Y%m%d')
				, DATE_FORMAT(NOW(),'%H%i%s')
				, #{regEmpKey}
				, 'N'
			)
		</foreach>
	</insert>
</mapper>